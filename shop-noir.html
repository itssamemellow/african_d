<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The African Diamond &mdash; Shop</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://db.onlinewebfonts.com/c/f1cfb0d208038e21ad90267089ab2584?family=Felix+Titling+V2"
      rel="stylesheet"
    />
    <link
      rel="shortcut icon"
      href="images/icons/head_icon.webp"
      type="image/x-icon"
    />
    <meta name="google-site-verification" content="gaJhfU-b7RMKpjCsvkp4mjwCBjWKElh3Qhawc5E9ut8" />
  </head>
  <body>
    <main id="shop-details">
      <header>
        <ul>
          <li class="homebutton">
            <a href="/"
              ><img id="logo" src="images/icons/main_logo.webp" alt="Full Logo"
            /></a>
          </li>
          <li><a href="about">ABOUT</a></li>
          <li><a href="wine">WINES</a></li>
          <li><a href="events">EVENTS</a></li>
          <li><a href="contact">CONTACT</a></li>
          <li id="active"><a href="shop">Shop</a></li>
          <li><a href="press">Blog</a></li>
        </ul>
        <nav class="hamburger" id="hamburger">
          <div>
            <span id="home">
              <a href="/"
                ><img
                  id="logo"
                  src="images/icons/main_logo.webp"
                  alt="Full Logo" /></a
            ></span>
            <span>
              <a href="about">ABOUT</a>
            </span>
            <span>
              <a href="wine">WINES</a>
            </span>
            <span>
              <a href="events">EVENTS</a>
            </span>
            <span>
              <a href="contact">CONTACT</a>
            </span>
            <span>
              <a href="shop">Shop</a>
            </span>
            <span>
              <a href="press">Blog</a>
            </span>
          </div>
        </nav>
      </header>

      <section class="noir-landing" id="landing">
        <h1>Our Wines</h1>
        <p>
          At The African Diamond, we craft wines that capture the essence of
          South Africa's diverse terroirs, expertly blending tradition with
          innovation. Whether you're enjoying a vibrant celebration or a quiet
          evening, our wines transform moments into memories.
        </p>
      </section>

      <!-- Wine section -->
      <section class="wine-shop" id="shop">
        <!-- Grenache Noir Section -->
        <section class="wine-card">
          <h2>Grenache Noir</h2>
          <span>
            <div id="image">
              <img src="images/assets\noir_bottle.png" alt="Grenache Noir" />
            </div>
            <div class="wine-item">
              <p>
                <strong>Description:</strong> </br>Sourced from the rare, dryland
                bush vine vineyards, our Grenache Noir showcases the intense
                concentration of flavours typical of these resilient vines.
              </p>
              <ul class="wine-details">
                <li>
                  <strong>Tasting Notes:</strong>
                  <p>
                    Luscious bright red fruit combined with smooth, chalky
                    tannins and a mouth-watering acidity. Beautifully structured
                    with a balanced finish.
                  </p>
                </li>
                <li>
                  <strong>Origin:</strong>
                  <p>Swartland, South Africa</p>
                </li>
                <li>
                  <strong>Vineyard:</strong>
                  <p>
                    Clay soils provide excellent moisture retention, allowing
                    the vines to flourish naturally.
                  </p>
                </li>
                <li>
                  <strong>Wine-making:</strong>
                  <p>
                    Wild fermented with 20% whole bunches and 15% juice
                    extraction. Aged in French oak barrels for 7 months.
                  </p>
                </li>
                <li>
                  <strong>Serve & Aging:</strong>
                  <p>
                    Best served at 12 to 16°C. Will develop further complexity
                    over the next 2 years.
                  </p>
                </li>
              </ul>
              <ul class="price">
              </ul>
              <h3>Price:</h3>
              <ul class="price">
                <li><p>Single Bottle: </p><span></span><em>R235.00</em></li>
                <li><p>Case (6 Bottles): </p><span></span><em>R1110.00</em></li>
                <li><p>Wine Duo (Blanc + Noir): </p><span></span><em>R370.00</em></li>
                <!-- <li><p>Current Status:</p><span></span><em id="stockstatus">Sold Out</em></li> -->
              </ul>
              <h4>Pairing Suggestions:</h4>
              <p>
                Pairs perfectly with roasted lamb, grilled vegetables, or dark
                chocolate.
              </p>

              <span id="btn">
                <button id="openOrderModal" class="order-button">Place Order</button>
                <a target="_blank" href="images/assets/AFRICAN_DIAMOND_Technical_Sheet_Grenache_Noir_2023.pdf" download="African Diamond - Grenache Noir Tasting Notes"><button>Download Full Tasting Notes</button></a>
              </span>
            </div>
          </span>
        </section>

        <!-- Order Modal -->
        <div id="orderModal" class="modal">
          <div class="modal-content">
            <span class="close" id="closeOrderModal">&times;</span>
            <h2>Place Your Order</h2>
    
            <!-- Order Form -->
            <form id="orderForm" action="https://www.payfast.co.za/eng/process" method="POST">
              <!-- PayFast Required Fields -->
              <input type="hidden" name="merchant_id" value="25233413">
              <input type="hidden" name="merchant_key" value="4tvvj2efmay1d">
              <input type="hidden" name="amount" value="100.00"> <!-- Amount in decimal format -->
              <input type="hidden" name="item_name" value="Test Item">
              <input type="hidden" name="return_url" value="https://theafricandiamond.co.za/payment-success">
              <input type="hidden" name="cancel_url" value="https://theafricandiamond.co.za/payment-cancelled.html">

              <!-- PayFast Payment Details -->
              <input type="hidden" id="pfAmount" name="amount" value="100.00">
              <input type="hidden" id="pfItemName" name="item_name" value="Order from The African Diamond">
              <div>
                <h4 class="noir">Grenache Noir</h4>
              <!-- Bottle Quantity -->
              <span id="quantity"><label for="noirBottleQty">Single Bottle (R235.00 each)</label>
              <input type="number" id="noirBottleQty" name="noirBottleQty" min="0" value="0"></span>

              <!-- Case Quantity -->
              <span id="quantity"><label for="noirCaseQty">Case of 6 Bottles (R1110.00)</label>
              <input type="number" id="noirCaseQty" name="noirCaseQty" min="0" value="0"></span>

              <h4 class="blanc">Grenache Blanc</h4>
              <!-- Bottle Quantity -->
              <span id="quantity"><label for="blancbottleQty">Single Bottle (R210.00 each)</label>
              <input type="number" id="blancbottleQty" name="blancbottleQty" min="0" value="0"></span>

              <!-- Case Quantity -->
              <span id="quantity"><label for="blancCaseQty">Case of 6 Bottles (R1080.00)</label>
              <input type="number" id="blancCaseQty" name="blancCaseQty" min="0" value="0"></span>

              <h4 class="duo">Special Offers</h4>
              <!-- Duo Quantity -->
              <span id="quantity"><label for="duoQty">Wine Duo (Blanc + Noir) (R370.00)</label>
              <input type="number" id="duoQty" name="duoQty" min="0" value="0"></span>
              </div>

              <!-- Name -->
              <label for="name">Full Name</label>
              <input type="text" id="name" name="name" placeholder="Enter your name" required>

              <!-- Delivery Address -->
              <label for="address">Delivery Address</label>
              <textarea id="address" name="address" placeholder="Enter your delivery address..." required></textarea>

              <!-- Payment Method
              <label for="payment">Payment Method</label>
              <select id="payment" name="payment" required>
                <option value="card">Credit/Debit Card</option>
                <option value="eft">EFT</option>
                <option value="paypal">PayPal</option>
              </select> -->

              <!-- Email -->
              <label for="email">Email</label>
              <input type="email" id="email" name="email" placeholder="Enter your email address" required>

              <!-- Shipping Fee -->
              <span id="payment"><label for="shipping">Shipping Fee</label>
              <p id="shippingFee">R0.00</p></span>

              <!-- Total Amount -->
              <span id="payment" class="total"><label for="totalAmount">Total Amount</label>
              <p id="totalAmount">R0.00</p></span>
              <button type="submit" class="submitBtn">Submit Order</button>
            </form>
          </div>
        </div>

        <!-- Customer Reviews -->
        <section class="customer-reviews">
          <section class="review-section">
            <h3>Rate this product:</h3>
            <div class="star-rating">
              <span class="star" data-value="1">&#9733;</span>
              <span class="star" data-value="2">&#9733;</span>
              <span class="star" data-value="3">&#9733;</span>
              <span class="star" data-value="4">&#9733;</span>
              <span class="star" data-value="5">&#9733;</span>
            </div>
            <p id="rating-value">No rating yet</p>
          </section>
    
          <!-- Key Metrics 
           <section class="key-metrics">
            <h3>Product Ratings</h3>
            <div class="metric">
              <p>Quality of Product:</p>
              <div class="rating-bar">
                <div class="bar" style="width: 90%;"></div>
              </div>
              <span>4.5/5</span>
            </div>
    
            <div class="metric">
              <p>Value of Product:</p>
              <div class="rating-bar">
                <div class="bar" style="width: 80%;"></div>
              </div>
              <span>4/5</span>
            </div>
    
            <div class="metric">
              <p>Purchase Again:</p>
              <div class="rating-bar">
                <div class="bar" style="width: 95%;"></div>
              </div>
              <span>4.8/5</span>
            </div>
          </section> -->
    
          <section class="cta-review">
            <a id="openReviewModal" class="review-button">Write a Review</a>
          </section>
        </section>
        
        <!-- Pop-up Review Modal -->
        <div id="reviewModal" class="modal">
          <div class="modal-content">
            <span class="close" id="closeModal">&times;</span>
            <h2>Submit Your Review</h2>
            
            <!-- Review Form -->
            <form id="reviewForm">
              <label id="ratingLabel" for="rating">Overall Rating<em>*</em></label>
              <div class="rating">
                <span class="star" data-value="5">&#9733;</span>
                <span class="star" data-value="4">&#9733;</span>
                <span class="star" data-value="3">&#9733;</span>
                <span class="star" data-value="2">&#9733;</span>
                <span class="star" data-value="1">&#9733;</span>
              </div>
              <p id="ratingDisplay">1 out of 5 stars selected. Product is poor.</p>
  
              <label for="reviewText">Review<em>*</em></label>
              <textarea id="reviewText" name="reviewText" placeholder="Write your review here..." required></textarea>
  
              <label for="reviewTitle">Review Title<em>*</em></label>
              <input type="text" id="reviewTitle" name="reviewTitle" placeholder="Example: Grenache Noir Taste" required>
  
              <label for="email">Your Email<em>*</em></label>
              <input type="email" id="r.email" name="email" required>
  
              <button type="submit" class="submitBtn">Submit Review</button>
            </form>
            <p class="required"><em>*</em> Required</p>
          </div>
        </div>

        <section class="shop-card" id="shop-card">
          <h2>Related Products</h2>
          <div class="balnc">
            <img src="images/assets/balnc_bottle.png" alt="Genache Blanc" />
            <h3>Grenache Blanc</h3>
            <span>
              <a href="shop-blanc">View Details</a>
            </span>
          </div>
        </section>
      </section>

      <!-- FAQ Section
      <section class="faq">
        <h2>FAQs</h2>
        <ul>
          <li>
            <strong>How should I store this wine?</strong> Store in a cool, dark
            place at a consistent temperature.
          </li>
          <li>
            <strong>How long will this wine age?</strong> Both wines will evolve
            in complexity for up to 2 years.
          </li>
          <li>
            <strong>What is the best way to serve it?</strong> Serve Blanc at
            10-12°C and Noir at 12-16°C.
          </li>
          <li>
            <strong
              >Where can I find The African Diamond in local stores?</strong
            >
            Use our store locator or contact us to find a stockist near you.
          </li>
        </ul>
      </section> -->

      <!-- Age Verification Modal -->
      <div id="age-check-modal" class="modal">
        <div class="modal-content">
            <img class="logo" src="images/icons/main_logo.webp" alt="Logo">
            <h2>Age <span class="highlight">Verification</span></h2>
            <p>Welcome to The African Diamond. </p>
            <p>We encourage responsible enjoyment of our wines. </br>
              By entering our site &mdash; you affirm that you are of legal drinking age.</p>
            <div class="modal-buttons">
                <button id="yes-button" class="proceed-btn">Agree</button>
                <button id="no-button" class="exit-btn">Close</button>
            </div>
            <p class="legal-info">
                Entering the site you agree with our 
                <a href="terms">terms and conditions</a> and 
                <a href="privacy-policy">privacy policy</a>.
            </p>
        </div>
    </div>

      <footer>
        <p><a href="privacy-policy">PRIVACY POLICY</a></p> | 
        <p><a href="terms">TERMS & CONDITIONS</a></p> | 
        <p>&copy; 2023 THE AFRICAN DIAMOND</p>
      </footer>
    </main>

    <div class="cursor"></div>
    <script src="script.js"></script>

    <script>
      const stars = document.querySelectorAll('.star');
      const ratingValue = document.getElementById('rating-value');

      // Handle star hover and click events
      stars.forEach(star => {
        star.addEventListener('mouseover', () => {
          resetStars();
          highlightStars(star.getAttribute('data-value'));
        });

        // Show selected rating on click
        star.addEventListener('click', () => {
          ratingValue.innerText = `You rated this product ${star.getAttribute('data-value')} out of 5!
          We'd love to hear your thoughts below.`;
        });
      });

      // Function to reset all stars
      function resetStars() {
        stars.forEach(star => star.innerHTML = '&#9733;');
      }

      // Function to highlight stars based on the rating
      function highlightStars(rating) {
        stars.forEach(star => {
          if (star.getAttribute('data-value') <= rating) {
            star.style.color = '#bb9339';
          } else {
            star.style.color = 'grey';
          }
        });
      }

      // Script for Review Modal and Form Handling

      // Elements
      const modal = document.getElementById("reviewModal");
      const openModalBtn = document.getElementById("openReviewModal");
      const closeModal = document.getElementById("closeModal");
      const form = document.getElementById("reviewForm");
      const starrate = document.querySelectorAll(".star");
      let rating = 1;

      // Open modal on button click
      openModalBtn.addEventListener("click", () => {
        modal.style.display = "flex";
      });

      // Close modal on clicking the close button
      closeModal.addEventListener("click", () => {
        modal.style.display = "none";
      });

      // Close modal on clicking outside the modal content
      window.onclick = function (event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };

      // Star rating logic
      starrate.forEach(star => {
        star.addEventListener("click", () => {
          // Remove selected class from all stars
          starrate.forEach(s => s.classList.remove("selected"));

          // Add selected class to clicked star and all previous stars
          star.classList.add("selected");
          for (let i = 0; i < star.dataset.value; i++) {
            starrate[i].classList.add("selected");
          }
    
          // Update rating
          rating = star.dataset.value;
          document.getElementById("ratingDisplay").textContent = `${rating} out of 5 stars selected.`;
        });
      });

      // Handle form submission
      form.addEventListener("submit", function (event) {
        event.preventDefault(); // Prevent default form submission

        // Form validation: check if all fields are filled
        const reviewText = document.getElementById("reviewText").value;
        const reviewTitle = document.getElementById("reviewTitle").value;
        const email = document.getElementById("r.email").value;

        if (!reviewText || !reviewTitle || !email) {
          alert("Please fill out all required fields.");
          return;
        }

        // Send form data via email (using mailto for this example)
        const subject = `New Review: ${reviewTitle}`;
        const body = `Rating: ${rating}/5\nReview: ${reviewText}\nEmail: ${email}`;
        const mailtoLink = `mailto:info@theafricandiamond.co.za?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  
        window.location.href = mailtoLink;

        // Close modal after submission
        modal.style.display = "none";
      });

      // Order Modal JavaScript
      const orderModal = document.getElementById('orderModal');
      const openOrderModal = document.getElementById('openOrderModal');
      const closeOrderModal = document.getElementById('closeOrderModal');
      const orderForm = document.getElementById('orderForm');

      const bottlePrice = 235;
      const casePrice = 1110;

      const blancBottlePrice = 210;
      const blancCasePrice = 1080;

      const duoPrice = 370;

      // Rates
      const localRate = 60;
      const domesticStandardRate = 80;

      const noirBottleQtyInput = document.getElementById('noirBottleQty');
      const noirCaseQtyInput = document.getElementById('noirCaseQty');
      const blancbottleQtyInput = document.getElementById('blancbottleQty');
      const blancCaseQtyInput = document.getElementById('blancCaseQty');
      const duoQtyInput = document.getElementById('duoQty');
      const totalAmountElement = document.getElementById('totalAmount');
      const shippingFeeElement = document.getElementById('shippingFee');
      const addressInput = document.getElementById('address');
      const pfAmountInput = document.getElementById('pfAmount');
      const pfItemNameInput = document.getElementById('pfItemName');

      // Function to calculate shipping fee based on address
      function calculateShippingFee() {
        const address = addressInput.value.toLowerCase();

        // Apply local rate if Johannesburg is mentioned, otherwise default to domestic
        if (/johannesburg|jhb/i.test(address)) {
          return { fee: localRate, label: 'Johannesburg Rate' };
        } else {
          return { fee: domesticStandardRate, label: 'Domestic Rate' };
        }
      }

      // Function to calculate total order amount
      function calculateTotal() {
        const noirBottleQty = parseInt(noirBottleQtyInput.value) || 0;
        const noirCaseQty = parseInt(noirCaseQtyInput.value) || 0;
        const blancbottleQty = parseInt(blancbottleQtyInput.value) || 0;
        const blancCaseQty = parseInt(blancCaseQtyInput.value) || 0;
        const duoQty = parseInt(duoQtyInput.value) || 0;

        const shipping = calculateShippingFee();
        shippingFeeElement.textContent = `R${shipping.fee.toFixed(2)} (${shipping.label})`;

        const totalAmount = (blancbottleQty * blancBottlePrice) + (blancCaseQty * blancCasePrice) + (noirBottleQty * bottlePrice) + (noirCaseQty * casePrice) + (duoQty * duoPrice) + shipping.fee;
        totalAmountElement.textContent = `R${totalAmount.toFixed(2)}`;

        // Update PayFast form fields
        pfAmountInput.value = totalAmount.toFixed(2); // PayFast amount

        // Create an array of items with non-zero quantities
        const selectedItems = [
          noirBottleQty > 0 ? `${noirBottleQty} Noir Bottles` : null,
          noirCaseQty > 0 ? `${noirCaseQty} Noir Cases` : null,
          blancbottleQty > 0 ? `${blancbottleQty} Blanc Bottles` : null,
          blancCaseQty > 0 ? `${blancCaseQty} Blanc Cases` : null,
          duoQty > 0 ? `${duoQty} Duos` : null,
        ].filter(item => item !== null); // Filter out null items

        // Join the selected items with commas and set it as the item name
        pfItemNameInput.value = selectedItems.join(', ');
      }

      // Update total amount and shipping fee when address or quantities change
      [addressInput, noirBottleQtyInput, noirCaseQtyInput, blancbottleQtyInput, blancCaseQtyInput, duoQtyInput].forEach(input => {
        input.addEventListener('input', calculateTotal);
      });

      // Open order modal on button click
      openOrderModal.addEventListener('click', () => {
        orderModal.style.display = 'flex';
        calculateTotal(); // Recalculate total when modal opens
      });

      // Close modal on clicking close button
      closeOrderModal.addEventListener('click', () => {
        orderModal.style.display = 'none';
      });

      // Close modal on clicking outside modal content
      window.onclick = function(event) {
        if (event.target == orderModal) {
          orderModal.style.display = 'none';
        }
      };

    </script>
  </body>
</html>
